<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARCHIVE_LOG</title>
    <link rel="stylesheet" href="SecretNyx.css">

    <style>
        .secret-line {
            width: 4px;
            height: 0px;
            background-color: #0f0;
            margin-top: 10px;
            opacity: 0;
            transition: height 2s ease-out, opacity 0.5s ease-out;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
        }

        .secret-line.active {
            height: 150px !important;
            opacity: 1 !important;
        }
    </style>
</head>
<body>

    <header>
        <h2>> ACCÈS LOGS SÉCURISÉS</h2>
        <h1>FICHIER_ARCHIVE.log</h1>
    </header>

    <main>
        <div class="audio-button" id="audioButton">
            <div class="icon" id="icon">&#x1F4D5;</div> 
            <div class="line-container" id="line"></div>
        </div>

        <div id="secretLine" class="secret-line"></div>

        <p class="teaser-text">> INITIATION DE LA LECTURE REQUISE_</p>
    </main>

    <footer>
        LOG SYSTEM • ENCODING: UTF-8 • TIMESTAMP: 2023-10-27
    </footer>

    <audio id="audioPlayer" src="Nyx.mp3"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const audioButton = document.getElementById('audioButton');
            const icon = document.getElementById('icon');
            const lineContainer = document.getElementById('line');
            const secretLine = document.getElementById('secretLine');
            const teaserText = document.querySelector('.teaser-text');
            const audioPlayer = document.getElementById('audioPlayer');
            
            let lineTimer;

            audioButton.addEventListener('click', () => {
                const isPlaying = audioButton.classList.contains('playing');

                if (isPlaying) {
                    // --- STOP ---
                    audioPlayer.pause(); 
                    audioButton.classList.remove('playing');
                    icon.textContent = '\u{1F4D5}';
                    teaserText.textContent = '> LECTURE SUSPENDUE_';
                    lineContainer.innerHTML = '';
                    
                    // ON NE CACHE PLUS LA LIGNE ICI
                    clearTimeout(lineTimer); 
                    // secretLine.classList.remove('active'); <--- Ligne supprimée

                } else {
                    // --- PLAY ---
                    audioPlayer.play(); 
                    audioButton.classList.add('playing');
                    icon.textContent = '\u{1F4D6}';
                    
                    // Si la ligne est DÉJÀ là, on garde le texte "Données enregistrées"
                    if (!secretLine.classList.contains('active')) {
                         teaserText.textContent = '> ANALYSE DU FLUX AUDIO...';
                    }

                    lineContainer.innerHTML = '';
                    
                    for (let i = 0; i < 30; i++) {
                        const bar = document.createElement('div');
                        bar.classList.add('wave-bar');
                        bar.style.animationDelay = `${Math.random() * 1.0}s`; 
                        lineContainer.appendChild(bar);
                    }

                    // Si la ligne n'est pas encore là, on lance le timer
                    if (!secretLine.classList.contains('active')) {
                        lineTimer = setTimeout(() => {
                            secretLine.classList.add('active');
                            teaserText.textContent = '> DONNÉES ENREGISTRÉES_';
                        }, 5000);
                    }
                }
            });

            audioPlayer.addEventListener('ended', () => {
                audioButton.classList.remove('playing');
                icon.textContent = '\u{1F4D5}';
                // On change le texte seulement si la ligne n'est PAS active
                 if (!secretLine.classList.contains('active')) {
                    teaserText.textContent = '> FIN DE TRANSMISSION_';
                }
                lineContainer.innerHTML = '';
                clearTimeout(lineTimer);
                // ON NE CACHE PLUS LA LIGNE ICI NON PLUS
                // secretLine.classList.remove('active'); <--- Ligne supprimée
            });
        });
    </script>

</body>
</html>