<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAS - ACCES DENIED</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
</head>
<body class="access-denied-body">

    <div class="glitch-wrapper">
        <div class="glitch-text-huge" data-text="ACCESS_DENIED">ACCESS_DENIED</div>
    </div>

    <main class="terminal access-denied-terminal">
        <h1 class="glitch-effect">VIOLATION DE PROTOCOLE<span class="blinker">_</span></h1>
        <p class="error-code glitch-effect">ERROR_CODE: 403-FORBIDDEN</p>
        <p class="warning-message glitch-effect">//: TENTATIVE D'ACCES NON AUTORISEE DETECTEE.</p>
        <p class="warning-message glitch-effect">//: TOUTE TENTATIVE D'INTRUSION AURA DE SEVERES CONSEQUENCES.</p>
        <p class="warning-message glitch-effect">//: VOTRE ACTIVITE EST ENREGISTREE.</p>

        <div class="data-glitch-block">
            <p>LOCAL_IP: <span class="data-glitched-red"></span></p>
            <p>ACCESS_ATTEMPT_FROM: <span class="data-glitched-red"></span></p>
            <p>TARGET_FILE: <span class="data-glitched-red"></span></p>
        </div>

        <footer class="portal-footer access-denied-footer">
            <a href="login.html" class="back-link glitch-effect">&lt;&lt; RETURN_TO_AUTHENTICATION_PORTAL</a>
        </footer>
    </main>

    <script>
        // Ce script injecte l'IP réelle de l'utilisateur (approximatif, côté client)
        // et le fichier qu'il essayait d'atteindre pour plus d'immersion
        document.addEventListener('DOMContentLoaded', function() {
            const ipSpan = document.querySelector('.data-glitch-block p:nth-child(1) .data-glitched-red');
            const attemptSpan = document.querySelector('.data-glitch-block p:nth-child(2) .data-glitched-red');
            const targetSpan = document.querySelector('.data-glitch-block p:nth-child(3) .data-glitched-red');

            // On récupère l'URL d'où la redirection a eu lieu
            const referrer = document.referrer; 
            const targetFile = referrer ? referrer.substring(referrer.lastIndexOf('/') + 1) : '[UNKNOWN_FILE]';
            
            // Pour l'IP, on utilise un service tiers (ATTENTION: ne pas utiliser en prod réelle, c'est un effet)
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    ipSpan.textContent = data.ip;
                    attemptSpan.textContent = data.ip; // On utilise la même pour l'effet
                })
                .catch(error => {
                    console.error('Erreur lors de la récupération de l\'IP:', error);
                    ipSpan.textContent = '[IP_RETRIEVAL_FAILED]';
                    attemptSpan.textContent = '[UNKNOWN_SOURCE]';
                });
            
            targetSpan.textContent = targetFile;
        });
    </script>

</body>
</html>